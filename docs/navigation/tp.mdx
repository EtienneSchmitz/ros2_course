---
sidebar_position: 3
sidebar_label: "ğŸ› ï¸ Travaux Pratiques"
---

# ğŸ› ï¸ TP : Navigation avec TurtleBot3

## Partie 1 â€” Mise en route du TurtleBot3 et tÃ©lÃ©opÃ©ration

:::caution Configuration rÃ©seau
Avant toute manipulation, assurez-vous que votre **PC (Remote PC)** et votre **TurtleBot3** est connectÃ© au mÃªme rÃ©seau.
:::

:::tip Ã‰vitez les conflits rÃ©seau entre groupes
ROS 2 utilise un systÃ¨me de communication basÃ© sur le multicast.  
Si **deux groupes** utilisent la **mÃªme configuration rÃ©seau** (mÃªme `ROS_DOMAIN_ID`, mÃªme nom d'hÃ´te, etc.), cela provoque des interfÃ©rences entre leurs robots : tÃ©lÃ©opÃ©ration instable, messages croisÃ©s, contrÃ´les partagÃ©s...

Pour Ã©viter cela, chaque groupe doit utiliser un `ROS_DOMAIN_ID` unique et un nom d'hÃ´te diffÃ©rent.

ğŸ’» ğŸ¤– Ajoutez la ligne suivante dans le fichier `~/.bashrc` de votre **PC** *et* du **TurtleBot3** :
```bash
export ROS_DOMAIN_ID=<votre_numÃ©ro_de_groupe>
```

ğŸ¤– Pour changer le nom d'hote du robot :
```bash
sudo hostnamectl set-hostname burger_<votre_numÃ©ro_de_groupe>
```
:::

### ğŸ¤– 1. Bringup du robot (TB3)

:::info PrÃ©requis Ã  lâ€™installation

Avant de commencer, assurez-vous que le TurtleBot3 est correctement configurÃ© avec lâ€™image systÃ¨me recommandÃ©e et que toutes les dÃ©pendances nÃ©cessaires pour ROS 2 sont bien installÃ©es sur les deux machines.

- ğŸ’» [Instructions pour votre PC](../install/pc#turtlebot-3-burger-robotis)  
- ğŸ¤– [Instructions pour le TurtleBot3](../install/turtlebot)
:::

:::note
Le terminal doit rester ouvert pendant toute la session avant de continuer les manipulations suivantes.
:::

ğŸ¤– Sur le TurtleBot3 (via SSH), lancez :
```
ros2 launch turtlebot3_bringup robot.launch.py
```

### ğŸ® 2. TÃ©lÃ©opÃ©ration clavier

ğŸ’» Depuis votre PC, ouvrez un nouveau terminal et lancez :
```bash
ros2 run turtlebot3_teleop teleop_keyboard
```

Gardez le terminal sÃ©lectionnÃ© (focus) pour pouvoir envoyer les commandes. 
Vous pouvez :
- Avancer, reculer
- Tourner Ã  gauche / droite
- Quittez avec Ctrl+C une fois les tests terminÃ©s

##### âœ… Ã€ vÃ©rifier :

- Le robot se dÃ©place bien dans les quatre directions
- Le dÃ©lai de rÃ©action est faible
- Aucune perte de connexion

## Partie 2 â€” CrÃ©ation de la carte avec Cartographer

Nous allons dÃ©sormais crÃ©er la carte de lâ€™environnement dans lequel votre TurtleBot3 Ã©voluera lorsquâ€™il naviguera de maniÃ¨re autonome.

### ğŸ§­ 1. Lancer le systÃ¨me de cartographie

ğŸ’» Sur **votre PC**, ouvrez un terminal et lancez :
```bash
ros2 launch turtlebot3_cartographer cartographer.launch.py
```

Cela va dÃ©marrer : 
- Le systÃ¨me **SLAM** (Cartographer)
- Lâ€™affichage RViz avec la carte en cours de construction
- La visualisation des scans du LIDAR

Vous devriez voir : 
- Le robot (en vert)
- Les donnÃ©es du LIDAR (points noirs)
- La carte qui se construit en gris au fur et Ã  mesure des dÃ©placements

### ğŸš¶â€â™‚ï¸ 2. DÃ©placement du robot pour cartographier

ğŸ’» Dans un nouveau terminal, lancez la tÃ©lÃ©opÃ©ration :

```bash
ros2 run turtlebot3_teleop teleop_keyboard
```

Gardez ce terminal sÃ©lectionnÃ© (focus clavier) pour pouvoir dÃ©placer le robot avec les touches.

â¡ï¸ Faites circuler doucement le robot pour explorer toutes les zones de la piÃ¨ce.
La carte sâ€™affine en temps rÃ©el grÃ¢ce au SLAM.

:::warning Ne quittez pas RViz ou le terminal !
La carte nâ€™est pas sauvegardÃ©e automatiquement. Gardez tous les terminaux ouverts jusquâ€™Ã  la sauvegarde.
:::

### ğŸ’¾ 3. Sauvegarder la carte

Une fois la cartographie terminÃ©e, vous pouvez sauvegarder la carte pour une utilisation ultÃ©rieure.
ğŸ’» Dans le terminal oÃ¹ vous avez lancÃ© Cartographer, exÃ©cutez :

```bash
mkdir ~/map 
ros2 run nav2_map_server map_saver_cli -f ~/map/map_workshop` 
```

Cela va crÃ©er un fichier `map_workshop.pgm` et un fichier `map_workshop.yaml` dans le dossier `~/map`.

Vous pouvez arrÃªtez l'ensemble des terminaux hormis le bringup du robot.

## Partie 3 â€” Navigation autonome avec Nav2

ğŸ’» Lancez le commande suivante pour lancer la localisation et la navigation autonome :
```bash 
ros2 launch turtlebot3_navigation2 navigation2.launch.py map:=$HOME/map/map_workshop.yaml
```

ğŸ‘€ Sur RViz vous devez voir le robot, les scans du LIDAR, les particules de AMCL et la carte que vous avez enregistrÃ©e.

ğŸ“ Si le robot est mal localisÃ©, utilisez l'outil *2D Pose Estimate* sur RViz. Cliquez et Glissez avec la souris pour positionner le robot sur la carte.

ğŸ“ Pour donner des ordres de navigation, utilisez l'outil *Nav2 Goal* sur RViz. Cliquez et Glissez avec la souris sur la carte lÃ  oÃ¹ le robot doit aller.

## Partie 4 â€” TP : Exploration autonome

ğŸ¯ L'objectif final du TP est de faire passer le robot par une suite de 2 ou 3 points de passage, comme pour une patrouille, avec un retour au point de dÃ©part. 

