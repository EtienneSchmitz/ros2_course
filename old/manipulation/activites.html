<!DOCTYPE HTML>
<html lang="fr" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Atelier - Manipulation avec ROS 2 - Workshop - ROS 2</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Workshop - ROS 2</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="atelier---manipulation-avec-ros-2"><a class="header" href="#atelier---manipulation-avec-ros-2">Atelier - Manipulation avec ROS 2</a></h1>
<p>Le bras robotisé WidowX-250 6DOF appartient à la famille des bras de la série X d'Interbotix, équipée des actionneurs DYNAMIXEL de la série X de Robotis.<br />
Les servomoteurs DYNAMIXEL XM430-W350 et DYNAMIXEL XL430-W250 offrent une haute résolution de 4096 positions et des paramètres PID définissables par l'utilisateur, ainsi que la surveillance de la température, le retour de position, les niveaux de tension, la charge et les paramètres de conformité accessibles à l'utilisateur. Au cœur du WidowX-250 6DOF se trouve le Robotis DYNAMIXEL U2D2 qui permet un accès facile au logiciel DYNAMIXEL Wizard ainsi qu'à ROS. Le WidowX-250 6DOF offre 6 degrés de liberté et une rotation complète de 360 degrés.</p>
<h2 id="1-comprendre-la-représentation-dun-robot-ros"><a class="header" href="#1-comprendre-la-représentation-dun-robot-ros">1. Comprendre la représentation d’un robot ROS</a></h2>
<p>Un robot intégré à ROS est composé d’au minimum :</p>
<ul>
<li>un descripteur URDF</li>
<li>un contrôleur qui gère les E/S avec le robot</li>
</ul>
<h4 id="11-comprendre-le-descripteur-urdf"><a class="header" href="#11-comprendre-le-descripteur-urdf">1.1. Comprendre le descripteur URDF</a></h4>
<p>Pour visualiser l'URDF du robot <code>wx250s</code>, lancer la commande suivante :</p>
<pre><code class="language-bash">ros2 launch urdf_tutorial display.launch.py model:=/home/$USER/interbotix_ws/src/interbotix_ros_manipulators/interbotix_ros_xsarms/interbotix_xsarm_descriptions/urdf/wx250s.urdf.xacro
</code></pre>
<p>⚠️ Dans <code>Global Options</code>, mettez la valeur de fixed frame à <code>wx250s/base_link</code> au lieu de <code>base_link</code>.</p>
<p>Vous pouvez aussi visualiser l'arbre du robot URDF :</p>
<pre><code class="language-bash">cd /home/$USER/interbotix_ws/src/interbotix_ros_manipulators/interbotix_ros_xsarms/interbotix_xsarm_descriptions/urdf/
ros2 run xacro xacro -o wx250s.urdf wx250s.urdf.xacro
urdf_to_graphviz wx250s.urdf
</code></pre>
<p>Ouvrez le PDF obtenu dans le dossier des descriptions du robot (<code>wx250s.pdf</code>) puis déterminez :</p>
<ul>
<li>Que représentent les rectangles ?</li>
<li>Que représentent les bulles ?</li>
<li>Que représentent les flèches et surtout les valeurs <code>xyz</code> et <code>rpy</code> associées ?</li>
</ul>
<h4 id="12-comprendre-les-es-du-contrôleur"><a class="header" href="#12-comprendre-les-es-du-contrôleur">1.2 Comprendre les E/S du contrôleur</a></h4>
<p>Lancer le robot avec la commande suivante :</p>
<pre><code class="language-bash">LC_NUMERIC=en_US.UTF-8 ros2 launch interbotix_xsarm_descriptions xsarm_description.launch.py robot_model:=wx250s use_joint_pub_gui:=true
</code></pre>
<h5 id="12a-topics-du-robot"><a class="header" href="#12a-topics-du-robot">1.2.a. Topics du robot</a></h5>
<p>✍ Avec l’utilitaire <code>ros2 topic</code>, lister les topics disponibles puis consultez celui qui décrit l’état courant des joints, en particulier :</p>
<ul>
<li>Quel est son nom ?</li>
<li>Quel est le type de message qu'il transmet ?</li>
<li>A quelle fréquence (en Hertz) est-ce qu'il met à jour l'état des joints ?</li>
</ul>
<h4 id="13-tracer-la-courbe-des-positions-des-moteurs-en-temps-réel"><a class="header" href="#13-tracer-la-courbe-des-positions-des-moteurs-en-temps-réel">1.3 Tracer la courbe des positions des moteurs en temps réel</a></h4>
<p>Lancer le robot avec la commande suivante :</p>
<pre><code class="language-bash">LC_NUMERIC=en_US.UTF-8 ros2 launch interbotix_xsarm_descriptions xsarm_description.launch.py robot_model:=wx250s use_joint_pub_gui:=true
</code></pre>
<p>✍  Démarrez <code>ros2 run rqt_graph rqt_graph</code>, démarrez le streaming <code>ROS Topic Subscriber</code>, et sélectionnez <code>/wx250s/joint_states</code>. Sélectionnez la position et la vitesse angulaire du moteur <code>m6</code> puis faîtes-les glisser sur le graphe. Bougez les moteurs à la main et vérifiez que les valeurs sont tracées en temps réel.</p>
<h3 id="2-cinématique-et-planification-avec-moveit-dans-rviz"><a class="header" href="#2-cinématique-et-planification-avec-moveit-dans-rviz">2. Cinématique, et planification avec MoveIt dans RViz</a></h3>
<p>Il y a une erreur dans le groupe <code>interbotix_gripper</code> pour MoveIt 2!</p>
<p>Modifier le fichier <code>~/interbotix_ws/src/interbotix_ros_manipulators/interbotix_ros_xsarms/interbotix_xsarm_moveit/config/controllers/wx250s_controllers.yaml</code>
Dans le group  <code>/wx250s/gripper_controller</code>, ajouter <code>right_finger</code>.</p>
<pre><code class="language-yaml">/wx250s/gripper_controller:
  action_ns: follow_joint_trajectory
  type: FollowJointTrajectory
  default: true
  joints:
    - left_finger
    - right_finger
</code></pre>
<h4 id="21-démarrer-avec-moveit-avec-un-robot-réel"><a class="header" href="#21-démarrer-avec-moveit-avec-un-robot-réel">2.1. Démarrer avec MoveIt avec un robot réel</a></h4>
<p>Démarrez MoveIt et Gazebo avec la commande suivante :</p>
<pre><code class="language-bash">LC_NUMERIC=en_EN.UTF-8 ros2 launch interbotix_xsarm_moveit xsarm_moveit.launch.py robot_model:=wx250s hardware_type:=gz_classic
</code></pre>
<p>Rviz doit démarrer avec un WidowX-250 6DOF en simulation gazebo.
<img src="./images/rviz.png" alt="Move it2" />.</p>
<h4 id="211-planification"><a class="header" href="#211-planification">2.1.1. Planification</a></h4>
<p>💻 Dans l'onglet Planning, section <strong>Query</strong> puis <strong>Planning group</strong>, sélectionnez le groupe <code>interbotix_arm</code>, bougez le goal (la sphère 3D bleue) en position et en orientation puis cliquez sur <strong>Plan</strong>.</p>
<p>✍ Une représentation orange 3D de robots se superposent avec le robot, déterminez son rôle de celui-ci eux en testant également la fonctionnalité <strong>Plan and Execute</strong>.</p>
<h4 id="212-planning-groups"><a class="header" href="#212-planning-groups">2.1.2. Planning groups</a></h4>
<p>💻✍ Testez également le groupe <code>interbotix_arm</code> en plus du premier <code>interbotix_gripper</code> et lancez des planifications de mouvement pour tester :</p>
<ul>
<li>Quelle est la différence entre ces 2 groupes ?</li>
<li>Quel est le groupe pour lequel le goal est le plus facilement manipulable ?</li>
<li>Pourquoi ce groupe est-il plus facilement manipulable que l'autre ?</li>
<li>Déduisez-en ce que désigne exactement un <code>planning group</code></li>
</ul>
<h4 id="213-interroger-larbre-des-transformations-tf-en-ligne-de-commande"><a class="header" href="#213-interroger-larbre-des-transformations-tf-en-ligne-de-commande">2.1.3. Interroger l'arbre des transformations <code>tf</code> en ligne de commande</a></h4>
<p>Nous allons visualiser et interroger l'arbre des transformations nommé <code>tf</code>.</p>
<p>💻✍ Démarrer MoveIt puis dans un autre terminal lancer <code>ros2 run tf2_tools view_frames</code>. Un fichier PDF nommé <code>frames.pdf</code> a été créé : les <code>frames</code> (repères géométriques) qu'ils contient sont les mêmes que ceux dessinés par Rviz en rouge-vert-bleu.</p>
<ul>
<li>Comment est nommé le repère de base ?</li>
<li>Comment sont nommés les deux effecteurs finaux possibles ?</li>
<li>La commande <code>ros2 run tf2_ros tf2_echo frameA frameB</code> renvoie la transformation actuelle de frameB dans frameA. Modifiez cette commande pour déterminer quelle est la position actuelle d'un des effecteurs dans le repère de base. Ses coordonnées peuvent vous servir par la suite, pour les définir comme cible à atteindre.</li>
</ul>
<h3 id="23-ecrire-un-noeud-python-ros"><a class="header" href="#23-ecrire-un-noeud-python-ros">2.3. Ecrire un noeud Python ROS</a></h3>
<p>Avec la documentation suivante : <a href="https://docs.trossenrobotics.com/interbotix_xsarms_docs/ros2_packages/python_demos.html">https://docs.trossenrobotics.com/interbotix_xsarms_docs/ros2_packages/python_demos.html</a>,
créer un monde gazebo où vous allez attraper un objet avec le robot WidowX-250.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../manipulation/installation.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../integration/activites.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../manipulation/installation.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../integration/activites.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
